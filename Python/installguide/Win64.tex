\lab{Appendix}{Windows 64 bit Installation}{Windows 64 bit}
\label{win64install}

\objective{Install fundamental package requirements for the labs on a Windows 64 bit machine.}

\begin{warn}
The information provided in this appendix is for convenience only.
The reader assumes all the liability and risk involved in making any change to configuration mentioned in this appendix.
The authors of this appendix are not responsible for any damage that may result from any changes covered in following material.
Some of the changes could cause unexpected behavior in the computer system.
\end{warn}

There are a wide variety of ways to install most of the Python packages required for these labs.
There are, however, some problems with Cython and F2py since the distutils package included in Python is currently not very good for building new extension modules on 64 bit Windows machines.
Installing these libraries can be difficult; the following are ways that have worked for us.
They still may not work on every computer.

\section*{Installing Using the Anaconda Python Distribution}
\begin{enumerate}
\item Note: you can get an academic license for more of the features of the Anaconda Distribution.
To activate your academic license, follow the steps in the confirmation email.

\item Install the Anaconda Python Distribution from \url{http://www.continuum.io/downloads}

\item Add the main Python directory and the bin/ , libs/ , and include/ subdirectories to your system path if they aren't already there.
You can find this option by opening the file explorer to "Computer", right clicking on the background and clicking on "Properties", then clicking on "Advanced Settings", then clicking on "Environment Variables", then add the following to the end of the path if it isn't already there: ";C:/Python27/; C:/Python27/Scripts; C:/Python27/libs; C:/Python27/include". This is best done to the path variable in the box for "System Variables".

\item Open "c:/Python27/Lib/site-packages/numpy/distutils/fcompiler/gnu.py" and comment out lines 330 and 331 which read \li{else:} and \li{raise NotImplementedError("Only MS compiler supported with gfortran on win64")}.

\item Search for the file "libmsvcr90.a" in your Python directory and copy it into "C:/Pyton27/libs"

\end{enumerate}


\section*{Installing Using the Enthought Python Distribution}
\begin{enumerate}

\item Install the Enthought Python distribution from \url{https://www.enthought.com/products/epd/} like this:
\begin{enumerate}
	\item Note: You can use EPD free, but academic licenses are available that, among other things give you access to the Intel MKL, which will make NumPy run faster.
		An academic license also allows you to use a 64 bit python installation and not just 32 bit.
	\item If you are using Windows Vista or later, you will need to unlock windows UAC before installing EPD.
		This option can be found in "control panel" under "user accounts."
		You will have to restart your computer after applying these settings.
		Make sure you turn it back on as soon as you have finished installing the Enthought Python distribution.
	\item Run the installer for the 64 bit windows version of the Enthought Python distribution.
		You will want to install for all users.
	\item Note: we will assume that you have installed Python under \li{c:/Python27/}
	\item Add the main Python directory and the bin/ , libs/ , and include/ subdirectories to your system path if they aren't already there.
You can find this option by opening the file explorer to "Computer", right clicking on the background and clicking on "Properties", then clicking on "Advanced Settings", then clicking on "Environment Variables", then add the following to the end of the path if it isn't already there: ";C:/Python27/; C:/Python27/Scripts; C:/Python27/libs; C:/Python27/include". This is best done to the path variable in the box for "System Variables".
\end{enumerate}
\item Install and upgrade the following additional packages from \url{http://www.lfd.uci.edu/~gohlke/pythonlibs/}
\begin{enumerate}
	\item NumPy
	\item SciPy
	\item Matplotlib
	\item SymPy
	\item libpython
	\item pip
	\item cython
	\item ipython
\end{enumerate}
\item Open "c:/Python27/Lib/distutils/cygwincompiler.py and remove the four instances of "-mno-cygwin" from the \li{__init__} method of the \li{Mingw32Compiler} class.
This is probably around line 322.
\item Open "c:/Python27/Lib/site-packages/numpy/distutils/fcompiler/gnu.py" and comment out lines 330 and 331 which read \li{else:} and \li{raise NotImplementedError("Only MS compiler supported with gfortran on win64")}.
\end{enumerate}

\begin{comment}

\section*{Installing MinGW64}
You may wish at some point to istall a 64 bit version of the MinGW compiler suite.
That can be done like this:
\begin{enumerate}
%% Installing mingw appears to be unnecessary since a compiler is included with EPD
%% I'm including these instructions here in case they prove to be necessary
%% In order to use 64 bit addressing, you would probably have to use mingw64
%% instead of the compiler included with enthought.
%% mingw is also included in anaconda.
\item Install 7zip from \url{http://www.7-zip.org/}
\item Install MinGw64 by downloading a precompiled binary from \url{http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/} 
\begin{enumerate}
	\item Unzip the package using 7-zip.
		We recommend a folder location like "c:/MinGW64"
	\item Add ";C:/MinGW64/bin;C:/MinGW64/include;C:/MinGW64/lib" to your user path.
		This is NOT your system path, it is your user path.
		They can both be edited in the same menu, but this will not work if it is in your system path.
\end{enumerate}
\end{enumerate}

\end{comment}

\section*{Other Miscellaneous Issues}
\begin{itemize}
\item If Python scripts are not recognizing their inputs modify the windows registry values as described \href{http://stackoverflow.com/questions/2640971/windows-is-not-passing-command-line-arguments-to-python-programs-executed-from-t}{here}.
\end{itemize}

