\lab{Applications}{Plotting With Matplotlib and Mayavi}{Plotting}
\objective{Introduce some of the basic plotting functions available in
Matplotlib and Mayavi} \label{lab:Matplotlib and Mayavi}

\section*{matplotlib}

Matplotlib is one of Python's many plotting libraries. Its high quality
and user interface explains why matplotlib serves as our primary
plotting library for 2D graphs in this text. It has an active
development community and was designed to resemble MATLAB.

Matplotlib has many different plotting functions and we strongly
encourage you to visit \url{http://matplotlib.org} for more
information.

\subsection*{simple plots} To get started, matplotlib is typically imported
like so 
\begin{lstlisting} 
from matplotlib import pyplot as plt
\end{lstlisting}

The basic line plotting function in matplotlib is \li{plot}. It takes a
set of data points and plots the line that is formed between those points. 
These plots are pieced together using a state machine environment, meaning that 
we can run several different functions and they will all display or modify the 
plot we are creating. 

To plot and show our function, the final two lines of code are always
\begin{lstlisting} 
plt.plot(x,y) 
plt.show() 
\end{lstlisting}

The user provides the x and y coordinates of these points. It is important that the 
coordinates provided are the same dimension for \li{plot} to work. 

We can generate a basic plot of $e^x$ using the following lines of code:
\lstinputlisting[style=fromfile]{explot.py}

Notice that \li{linspace} is extremely useful in plotting since it produces evenly spaced values 
between a given interval. The default number is 50, but was adjusted in the previous 
code to be 501. 

This should display a plot similar to the one shown in Figure
\ref{mpl:explot}.

\begin{figure}
\includegraphics[width=\textwidth]{explot.pdf}
\caption{A simple plot of $e^x$.} 
\label{mpl:explot} 
\end{figure}

\subsection*{multiple plots}
We can use the state based interface to display multiple plots at once. 
The following code will plot lines with random values at integers from 1 to 10. 

\lstinputlisting[style=fromfile]{statemachine1.py}

In this example we have used the plot function to plot several different
lines at once. But there is a better way. We can overlay different plots onto 
one another. Using the same x and y that we generated above, the following will give
us the same plot:

\lstinputlisting[style=fromfile]{statemachine2.py}

Yet, the most efficient way to create this plot would be with a loop.

\lstinputlisting[style=fromfile]{statemachine3.py}

A plot that was generated by this code will be similar to the one shown
in Figure \ref{mpl:statemachineexample}.

\begin{figure}
\includegraphics[width=\textwidth]{statemachine.pdf}
\caption{A plot of $10$ lines with randomly generated $y$ values.}
\label{mpl:statemachineexample} 
\end{figure}

Note that a suitable domain and range for your plot is automatically chosen 
unless specified otherwise. 

\begin{problem} Plot the function $\sin(x)$ from $0$ to $2\pi$ with a red dashed 
line. Then plot the function $\cos(x)$ on the same domain with a blue dotted line 
using a single call to the plot function. 
\end{problem}


\begin{comment}
There are also many functions that we may use to set different values in
the plotting environment. A few examples are shown in Table
\ref{mpl:useful_functions}.

\begin{table}
\begin{center} 
\begin{tabular}{|l|p{6cm}|p{4cm}|}

    \hline

    Function & Description & Usage\\

    \hline

    \li{annotate} & adds a commentary at a given point on the plot &
    annotate('text',(x,y))\\

    \li{arrow} & draws an arrow from a given point on the plot &
    arrow(x,y,dx,dy)\\

    \li{axhline} & draws a horizontal line at y from xmin to xmax &
    axhline(y=0, xmin=0, xmax=1)\\

    \li{axvline} & draws a vertical line at x from ymin to ymax &
    axvline(x=0, ymin=0, ymax=1)\\

    \li{axhspan} & draws a rectangle from xmin to xmax and ymin to ymax,
    if no xmin and xmax are given it goes across the plot &
    axhspan(ymin, ymax, xmin=0, xmax=1)\\

    \li{axvspan} & draws a rectangle from ymin to ymax and xmin to xmax,
    if no ymin and ymax are given it goes across the entire plot &
    axvspan(xmin, xmax, ymin=0, ymin=1)\\

    \li{figlegend} & place a legend in the plot & figlegend(handles,
    labels, loc)\\

    \li{grid} & add gridlines & grid()\\

    \li{text} & add text at a given position on the plot &
    text(x,y,'text')\\

    \li{title} & add a title to the plot & title('text')\\

    \li{xlim} & set the x limits, returns current limits if no arguments
    are given & xlim(xmin,xmax)\\

    \li{ylim} & set the y limits, returns current limits if no arguments
    are given & ylim(ymin,ymax)\\

    \li{xticks} & set the location of the tick marks on the x axis,
    returns current locations if no arguments are given & xticks(x)\\

    \li{yticks} & set the location of the tick marks on the y axis,
    returns current locations if no arguments are given & yticks(y)\\

    \li{xlabel} & add a label to the x axis & xlabel('text')\\

    \li{ylabel} & add a label to the y axis & ylabel('text')\\

    \hline

    \end{tabular} 
    \end{center} 
    \caption{Some Functions to Set Plotting Options} 
    \label{mpl:useful_functions} 
    \end{table}

	\end{comment}
	
\begin{problem} Plot the curve $\frac{1}{x-1}$ from $-2$ to $6$ with a 
magenta dashed line. Force the plot to only show $y$ values that are between 
$-6$ and $6$.  By default \texttt{plot} will try to make the graph connected.  
Correct this so that the graph appears to be discontinuous at $x=1$, as it should be.
Also make your line width 5.

Your plot should look like Figure \ref{mpl:problem2} 
\end{problem}

\begin{figure}
\includegraphics[width=\textwidth]{prob2.pdf}
\caption{Your solution to problem 2 should look like this.}
\label{mpl:problem2} 
\end{figure}

\begin{problem} Plot the curve $\sin(x)\frac{1}{x+1}$ from $0$ to $10$.
Use blue shading under the curve when it is positive and red when it is
negative (Hint: you may want to use the \verb!fill_between! command).
Make the line dotted. Label the x-axis ``x-axis", the y-axis ``y-axis",
and the plot ``My Plot". Enable the gridlines.

Also include a scatter plot of half of the value of the function at each
of it's maxima and minima in the range. Have it display the points as
blue triangles. Make sure the x limits of the plot are still 0 and 10.

Your plot should look like Figure \ref{mpl:problem3}.
\end{problem}

\begin{figure}
\includegraphics[width=\textwidth]{prob3.pdf}
\caption{Your solution to problem 3 should look like this.}
\label{mpl:problem3} 
\end{figure}

\begin{comment}
Some other useful functions available in pyplot include imread, which
imports an image as an array, and imshow, which displays an image from
an array.
\end{comment}


\subsection*{pcolormesh}
Pcolormesh is a function in pyplot. It is used to plot a quadrilateral mesh, 
meaning it produces a pseudocolor plot of a 2D array. 

The following is an example of using the pcolormesh function to represent 
the surface $z=\sin(x)\sin(y)$:

\lstinputlisting[style=fromfile]{sinxsiny.py}
 
This plot is shown in Figure \ref{mpl:pcmexample}

\begin{figure} 
\includegraphics[width=\textwidth]{sinxsiny.pdf}
\caption{Color plot of $\sin\left(x\right)\times\sin\left(y\right)$.}
\label{mpl:pcmexample} 
\end{figure}

\begin{problem} Use plt.pcolormesh to plot the absolute value of the function 
$x^3 +2x^2 -x +3$ on the complex plane.

Your plot should look like Figure \ref{mpl:pcolormesh} 
\end{problem}


\begin{figure} 
\includegraphics[width=\textwidth]{pcolor2.png}
\caption{Another example of a colorplot.} 
\label{mpl:pcolormesh}
\end{figure}


\begin{comment}

Matplotlib can also be used for 3D plotting. The following is an example
of how to use matplotlib to plot the function $z=\sin(x)\sin(y)$ with
both x and y ranging from -6 to 6. The resulting plot is shown in Figure
\ref{mpl:3dplot}. If you change the number of sample points used you
will notice that graphs look much nicer with large numbers of sample
points, but it will also take much longer for your computer to render
the image.

\begin{lstlisting} from mpl_toolkits.mplot3d import Axes3D from
matplotlib import pyplot as plt import numpy as np fig = plt.figure() ax
= fig.gca(projection='3d') x = np.linspace(-6, 6, 301) y =
np.linspace(-6, 6, 301) X, Y = np.meshgrid(x, y) Z = np.sin(X) *
np.sin(Y) ax.plot_surface(X, Y, Z) plt.show() \end{lstlisting}

\begin{figure} \includegraphics[width=\textwidth]{3dplot.pdf} \caption{A
3D plot of $\sin\left(x\right)\times\sin\left(y\right)$.}
\label{mpl:3dplot} \end{figure}

\begin{problem} Plot the function \begin{equation*}
\frac{\cos\left(\sqrt{x^2 + y^2}\right)}{\frac{x^2 + y^2}{10} + 1}
\end{equation*} on $[-10, 10] \times [-10, 10]$. \end{problem}


Matplotlib also allows us to make interactive graphs as follows:

% This example is largely based on one of the examples in the matplotlib
% docs. I have simplified it and changed the way the libraries are
% imported, but we could do a citation anyway.
% 
\begin{lstlisting} import numpy as np from matplotlib import pyplot as
plt from matplotlib import widgets as wg ax = plt.subplot(111)
plt.subplots_adjust(bottom=.25) t = np.arange(0., 1., .001) a0 = 5. f0 =
3. s = a0 * np.sin(2 * np.pi * f0 * t) l = plt.plot(t, s)[0]
plt.axis([0, 1, -10, 10]) axfreq = plt.axes([.25, .05, .65, .03]) axamp 
= plt.axes([.25, .1, .65, .03]) sfreq = wg.Slider(axfreq, 'Freq', .1,
30., valinit=f0) samp = wg.Slider(axamp, 'Amp', .1, 10., valinit=a0) def
update(val): amp = samp.val freq = sfreq.val l.set_ydata(amp * np.sin(2
* np.pi * freq * t)) plt.draw() sfreq.on_changed(update)
samp.on_changed(update) plt.show() \end{lstlisting} The resulting plot
is shown in Figure \ref{mpl:interact}.

\begin{figure} \includegraphics[width=\textwidth]{interact.pdf}
\caption{A snapshot of an interactive plot made using Matplotlib.}
\label{mpl:interact} \end{figure}

\begin{problem} Modify the code above to add a third slider to
manipulate the phase of the wave shown. Have it range from 0 to $2\pi$
and set the default value to zero. \end{problem}

\end{comment}

\section*{subplots}

We can plot multiple images at the same time using the \li{plt.subplot} command. 
It takes 3 arguments: the number of rows, the numer of columns, and the plot number. 
The plot number starts at 1 and increments first across the rows. 
For each subplot, preface the code needed with
\begin{lstlisting}
plt.subplot(nrows, ncols, plot_number)
\end{lstlisting}
However, if all the arguments are each less than 10, the commas can be 
omitted. 
\begin{lstlisting}
plt.subplot(nrowsncolsplot_number)
\end{lstlisting}
Note that with each subplot, only the plot number changes. 

The following example showcases plots of $sin x$ and $cos x$ on two 
different axes within the same plot.

Figure \ref{mpl:subplots} is the output from the following code:

\lstinputlisting[style=fromfile]{subplots.py}

\begin{figure} 
\includegraphics[width=\textwidth]{subplots.pdf}
\caption{An example of the use of subplots in Matplotlib.}
\label{mpl:subplots} 
\end{figure}

\subsection*{Titles and Labels}

We can add titles to each subplot using the \li{plt.title} function. The
\li{plt.suptitle} function allows us to give the entire figure a title
as well.

\begin{problem} Make a plot with 4 subplots. In the subplots place
graphs of $e^x$, $sin(x)$, $cos(x)$, and $x^2$. Plot all of them on the
interval $(-\pi,\pi)$. Title each of them accordingly. Title the entire
figure ``My Different Plots." 
\end{problem}

\begin{comment} 
%Table \ref{mpl:basics} 
\begin{table} 
\begin{center}
\begin{tabular}{|l|p{7cm}|p{3cm}|}

    \hline

    Function & Description & Usage\\

    \hline

    \li{bar} & makes a bar graph & bar(left,height)\\

    \li{barh} & makes a horizontal bar graph & barh(bottom,width)\\

    \li{fill} & plots lines with shading under the curve & fill(x,y)\\

    \li{fill\_between} & plots lines with shading between two given y
    values & fill\_ between(x,y1, y2=0)\\

    \li{hist} & plots a histogram from data & hist(data)\\

    \li{pie} & make a pie chart & pie(x)\\

    \li{plot} & plots lines and data on standard axes & plot(x,y)\\

    \li{polar} & plots lines and data on polar axes & polar(theta,r)\\

    \li{loglog} & plots lines and data on logarithmic x and y axes &
    loglog(x,y)\\

    \li{scatter} & plots data, has more options for scatter plots than
    the plot function & scatter(x,y)\\

    \li{semilogx} & plots lines and data with a log scaled x axis &
    semilogx(x,y)\\

    \li{semilogy} & plots lines and data with a log scaled y axis &
    semilogy(x,y)\\

    \li{specgram} & make a spectogram from data & specgram(x)\\

    \li{spy} & plot the sparsity pattern of a 2D array & spy(Z)\\

    \li{triplot} & plot triangulation between given points &
    triplot(x,y)\\

    \hline

    \end{tabular} 
    \end{center} 
    \caption{Some basic functions in Matplotlib.} 
    \label{mpl:basics} 
    \end{table} 
    
    
    \end{comment}




\section*{mayavi}

Matplotlib is the preferred library for 2D plotting.  
We will now consider Mayavi for 3D plotting. 
It is a general scientific data visualizer that seeks to provide interactive 
visualization of 3D data. 
It provides easy integration with Python scientific libraries and maintains a 
rich user interface that allows interaction with all data and objects. 




Matplotlib is one of Python's many plotting libraries. Its high quality
and user interface explains why matplotlib serves as our primary
plotting library for 2D graphs in this text. It has an active
development community and was designed to resemble MATLAB.

Matplotlib has many different plotting functions and we strongly
encourage you to visit \url{http://matplotlib.org} for more
information.


\subsection*{simple plots} To get started, matplotlib is typically imported
like so 
\begin{lstlisting} 
from matplotlib import pyplot as plt
\end{lstlisting}

The basic line plotting function in matplotlib is \li{plot}. It takes a
set of data points and plots the line that is formed between those points. 
These plots are pieced together using a state machine environment, meaning that 
we can run several different functions and they will all display or modify the 
plot we are creating. 

To plot and show our function, the final two lines of code are always
\begin{lstlisting} 
plt.plot(x,y) 
plt.show() 
\end{lstlisting}

The user provides the x and y coordinates of these points. It is important that the 
coordinates provided are the same dimension for \li{plot} to work. 

We can generate a basic plot of $e^x$ using the following lines of code:
\lstinputlisting[style=fromfile]{explot.py}

